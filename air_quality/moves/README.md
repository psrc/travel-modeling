# Automating MOVES Runs
This repository includes a set of scripts that allows automation of multiple MOVES runs as well as exporting of results to CSV files. The **configuration.toml** file includes working directories, lists of years to run and which scripts to run. See project directories (e.g. 2026_2050_RTP for an example configuration file.)

The main script **run_all.py** processes up to five difference python scripts, which helps automate the generation of inputs for multiple counties and years. Update information in the configuration TOML file and run this script to generate year-specific data, produce the database XML files, and MOVES Run Specification (MRS) files.  

Once these text files are generated, use the batch files (available in project directories such as *2026_2050_RTP*) through MOVES to generate input and output databases and start MOVES runs. These batch files should be copied to a directory without spaces in the path (e.g., on the T drive). They must be run from the MOVES directory. Navigate to the following location and run the "setenv" command to run the batch files with MOVES.
  `C:\Users\Public\EPA\MOVES\MOVES4.0> setenv`

The .mrs and .xml files in the local directory will be processed by the batch files, so copy the files that were built from the scripts generated by **run_all.py**. Update the path to this location in the batch files and run the batch files from the command prompt at the MOVES3 install location. 
- Run **create_input_db.bat** first: this file creates all the database files from input in the XML files
- Next run **batch_run.bat**: this will iterate through each MRS file in the directory, running MOVES for each one.

## Results
Results will be available in the output database defined in **configuration.toml**, as specified in the db_tag field. To export results, set `run_export_moves_data = true` and `run_create_soundcast_input = true`, which will extract results from databse tables and combine multiple years in two files that serve as inputs to soundcast:
- running_emission_rates_by_veh_type.csv
- start_emission_rates_by_veh_type.csv

See the [old_README.md](https://github.com/psrc/travel-modeling/blob/master/air_quality/moves/2022_2050_RTP/old_README.md) for more detailed information. 
